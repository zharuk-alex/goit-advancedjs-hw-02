{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-timer.js"],"sourcesContent":["import flatpickr from 'flatpickr';\nimport iziToast from 'izitoast';\nimport 'flatpickr/dist/flatpickr.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n\nconst addLeadingZero = value => value.toString().padStart(2, '0');\n\nconst data = {\n  timerID: null,\n  targetTimestamp: null,\n};\n\nconst refs = {\n  datePicker: document.querySelector('#datetime-picker'),\n  startBtn: document.querySelector('button[data-start]'),\n  fields: {},\n};\n\nArray.from(document.querySelectorAll('.field .value')).map(ref => {\n  const key = Object.keys(ref.dataset)?.[0];\n  refs.fields[key] = ref;\n});\n\nflatpickr(refs.datePicker, {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  onClose: pickerCloseHandler,\n});\n\nconst renderTime = timestamp => {\n  // days, hours, minutes, seconds\n  const timeParsed = convertMs(timestamp);\n  Object.keys(timeParsed).forEach(key => {\n    if (!!refs.fields?.[key]) {\n      refs.fields[key].textContent = addLeadingZero(timeParsed[key]);\n    }\n  });\n};\n\nconst startIsAble = () => {\n  if (data.targetTimestamp - Date.now() > 0) {\n    return true;\n  }\n  refs.startBtn.setAttribute('disabled', true);\n  data.targetTimestamp = null;\n\n  iziToast.error({\n    title: 'Error',\n    position: 'topCenter',\n    message: 'Please choose a date in the future',\n  });\n\n  return false;\n};\n\nfunction pickerCloseHandler(selectedDates) {\n  data.targetTimestamp = selectedDates[0].getTime();\n  if (startIsAble()) {\n    refs.startBtn.removeAttribute('disabled');\n  }\n}\n\nrefs.startBtn.addEventListener('click', function () {\n  if (!startIsAble()) {\n    return false;\n  }\n\n  this.setAttribute('disabled', true);\n  refs.datePicker.setAttribute('disabled', true);\n\n  data.timerID = setInterval(() => {\n    const diff = data.targetTimestamp - Date.now();\n\n    if (diff <= 0) {\n      refs.datePicker.removeAttribute('disabled');\n      clearInterval(data.timerID);\n      iziToast.success({\n        title: 'Thank you!',\n        position: 'topLeft',\n      });\n      return;\n    }\n\n    renderTime(diff);\n  }, 1000);\n});\n"],"names":["convertMs","ms","days","hours","minutes","seconds","addLeadingZero","value","data","refs","ref","key","_a","flatpickr","pickerCloseHandler","renderTime","timestamp","timeParsed","startIsAble","iziToast","selectedDates","diff"],"mappings":"+IAKA,SAASA,EAAUC,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAEA,MAAMC,EAAiBC,GAASA,EAAM,SAAU,EAAC,SAAS,EAAG,GAAG,EAE1DC,EAAO,CACX,QAAS,KACT,gBAAiB,IACnB,EAEMC,EAAO,CACX,WAAY,SAAS,cAAc,kBAAkB,EACrD,SAAU,SAAS,cAAc,oBAAoB,EACrD,OAAQ,CAAE,CACZ,EAEA,MAAM,KAAK,SAAS,iBAAiB,eAAe,CAAC,EAAE,IAAIC,GAAO,OAChE,MAAMC,GAAMC,EAAA,OAAO,KAAKF,EAAI,OAAO,IAAvB,YAAAE,EAA2B,GACvCH,EAAK,OAAOE,CAAG,EAAID,CACrB,CAAC,EAEDG,EAAUJ,EAAK,WAAY,CACzB,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAASK,CACX,CAAC,EAED,MAAMC,EAAaC,GAAa,CAE9B,MAAMC,EAAajB,EAAUgB,CAAS,EACtC,OAAO,KAAKC,CAAU,EAAE,QAAQN,GAAO,QAC/BC,EAAAH,EAAK,SAAL,MAAAG,EAAcD,KAClBF,EAAK,OAAOE,CAAG,EAAE,YAAcL,EAAeW,EAAWN,CAAG,CAAC,EAEnE,CAAG,CACH,EAEMO,EAAc,IACdV,EAAK,gBAAkB,KAAK,IAAG,EAAK,EAC/B,IAETC,EAAK,SAAS,aAAa,WAAY,EAAI,EAC3CD,EAAK,gBAAkB,KAEvBW,EAAS,MAAM,CACb,MAAO,QACP,SAAU,YACV,QAAS,oCACb,CAAG,EAEM,IAGT,SAASL,EAAmBM,EAAe,CACzCZ,EAAK,gBAAkBY,EAAc,CAAC,EAAE,QAAO,EAC3CF,EAAW,GACbT,EAAK,SAAS,gBAAgB,UAAU,CAE5C,CAEAA,EAAK,SAAS,iBAAiB,QAAS,UAAY,CAClD,GAAI,CAACS,EAAW,EACd,MAAO,GAGT,KAAK,aAAa,WAAY,EAAI,EAClCT,EAAK,WAAW,aAAa,WAAY,EAAI,EAE7CD,EAAK,QAAU,YAAY,IAAM,CAC/B,MAAMa,EAAOb,EAAK,gBAAkB,KAAK,IAAG,EAE5C,GAAIa,GAAQ,EAAG,CACbZ,EAAK,WAAW,gBAAgB,UAAU,EAC1C,cAAcD,EAAK,OAAO,EAC1BW,EAAS,QAAQ,CACf,MAAO,aACP,SAAU,SAClB,CAAO,EACD,MACD,CAEDJ,EAAWM,CAAI,CAChB,EAAE,GAAI,CACT,CAAC"}